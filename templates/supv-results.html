{% extends "bootstrap/base.html" %}
{% block scripts %}
  {{ super() }}
  <script>
  function checkAll() {
    let checkboxes = document.getElementsByClassName('checkbox')
    for(let i = 1; i < checkboxes.length; i++){ 
      checkboxes[i].checked = checkboxes[0].checked;
    } 
    checkboxes[0].checked = !checkall[0].checked;
  }

  function checkSelection(){
    let checkboxes = document.getElementsByClassName('checkbox')
    let allChecked = true
    for(let i = 1; i < checkboxes.length; i++){ 
      allChecked = (checkboxes[i].checked && allChecked);
    }
    if (allChecked){
      checkboxes[0].checked = true;
    }else{
      checkboxes[0].checked = false;
    }
  }
  </script>
{% endblock %}
{% block content %}
<div class="container">
<h3 class="pt-3">Search Results</h3>
{% if message != '' %}
  <hr>
  <p><strong>{{ message }}</strong></p>
{% endif %}
<form method="POST" id="SupvEditForm" action="{{ url_for('supv_results') }}">
<table class="table">
  <tr>
    <th class="center-align"><input type="checkbox" class="checkbox" name="checkall" onclick="checkAll()"></th>
    <th>Name</th>
    <th>Date</th>
    <th>Clock In</th>
    <th>Clock Out</th>
    <th>Holiday/PTO</th>
    <th>Hours</th>
    <th>Approval Status</th>
  </tr>
  {% for data in results %}
    <tr>
      <td class="center-align"><input type="checkbox" class="checkbox" name="selection" value="{{ data['id'] }}" onclick="checkSelection()"></td>
      <td>{{ data['name'] }}</td>
      <td>{{ data['date_conv'] }}</td>
      <td>{{ data['clock_in'] }}</td>
      <td>{{ data['clock_out'] }}</td>
      <td>{{ data['pto'] }}</td>
      <td>{{ data['hours'] }}</td>
      <td>{{ data['approval'] }}</td>
    </tr>
{% endfor %}
</table>

<!-- Used for reconstructing the table later -->
<input type="hidden" name="first_date" value="{{ first_date }}">
<input type="hidden" name="last_date" value="{{ last_date }}">
<!-- True if all employees was selected, false otherwise -->
<input type="hidden" name="all_flag" value="{{ all_flag }}">
<!-- Takes the employ_id of the first entry, will not be used if all_flag = True -->
<input type="hidden" name="employ_id" value="{{ results[0]['employ_id'] }}">

<p>Select what entries you would like to adjust above.</p>
<p>Note: any entries that are edited will be unapproved.</p>
<div class="form-check form-check-inline">
  <label class="form-check-label"><input class="form-check-input" type="radio" name="choice" value="approve" checked> Approve selection</label>
</div>
<div class="form-check form-check-inline">
  <label class="form-check-label"><input class="form-check-input" type="radio" name="choice" value="unapprove"> Unapprove selection</label>
</div>
<div class="form-check form-check-inline">
  <label class="form-check-label"><input class="form-check-input" type="radio" name="choice" value="edit"> Edit entry (only one)</label>
</div>
<div class="form-check form-check-inline">
  <label class="form-check-label"><input class="form-check-input" type="radio" name="choice" value="delete"> Delete selection</label>
</div>

<div class="form-group">
  <p class="pt-3"><input class="btn btn-primary" type="submit" value="Submit Choice"></p>
</div>
</form>
<hr>
<p><a href="{{ url_for('supv') }}">Go back to the Supvervisor Hub</a></p>
<p><a href="{{ url_for('index') }}">Logout and return to the Main Hub</a></p>
<hr>
</div>
{% endblock %}
